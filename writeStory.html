<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8" />
    <title>GE ITLP Pyramid</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.0.8/semantic.css"/>
    <link rel="stylesheet" href="custom.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.0.8/semantic.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.3/handlebars.min.js"></script>
    <script src="utils.js"></script>
</head>
<body>

  <!-- TEMPLATES -->

  <!-- MENU -->

  <div class="ui stackable container menu inverted">
    <a href="index.html" class="item">Stories</a>
    <a id="aWriteStory" href="writeStory.html?isAuthor=1" class="hide item right">Write Story</a>
    <a id="aApproveStory" href="approveStories.html?isApprover=1" class="hide item right">Approve Stories</a>
  </div>

  <!-- STORY FORM -->

  <h1 class="ui center aligned header">Submit a Story</h1>
  <div class="ui container">
    <div id="storyForm" class="ui form">
      <div class="field">
        <label for="nominee">Nominee SSO</label>
        <input type="text" id="nominee" name="nominee" placeholder="Nominee SSO">
      </div>
      <div class="field">
        <label for="title">Title</label>
        <input type="text" id="title" name="title" placeholder="Title">
      </div>
      <div class="field">
        <label for="body">Story</label>
        <textarea name="body" id="body"></textarea>
      </div>
      <button class="ui button primary" id="submitStory">Submit</button>
    </div>
  </div>

  <script type="text/javascript">
      var user = JSON.parse(localStorage.getItem('user'));

    $('#submitStory').click(function() {

      $('#storyForm').addClass("loading");
      var myData =  {
          author: user.sso,
          nominee: $('#nominee').val(),
          title: $('#title').val(),
          body: $('#body').val()
        };
      $.ajax({
        url: 'http://itlp.herokuapp.com/add/story/',
        type: 'get',
        data: myData
      })
      .done(function(response){
        $('#storyForm').removeClass("loading");
        console.log(response);
      });
    });

    if (user.isApprover) {
      $('#aApproveStory').removeClass('hide');
    }
    if (user.isAuthor) {
      $('#aWriteStory').removeClass('hide');
    }
  </script>
</body>
</html>
